(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var s=n.getElementsByTagName("script");if(s.length)for(var i=s.length-1;i>-1&&!t;)t=s[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),(()=>{class e{static list(){const e=[],t=document.cookie.split("; ");for(let n=0;n<t.length;n++){const s=t[n].split("="),i=s[0];let c=s.length>1?s[1]:null;e.push({name:i,value:c})}return e}static find(e=""){return this.list().find((t=>t.name===e))||null}static create(e,t,n=1,s="/"){const i=new Date,c=new Date(i.getTime()+24*n*60*60*1e3);return document.cookie=`${e}=${t}; expires=${c}; path=${s}`,this}static delete(e){return document.cookie=`${e}=; Max-Age=-99999999;`,this}}class t{#e=null;#t=null;#n=null;#s=[];screens=["notice","preferences","toggle-preferences"];consentCookieName="cl_consent";cookieNames=["cl_consent","cl_essential","cl_tracking","cl_marketing"];defaultSettings={baseUrl:null,userOpt:!1,consentMode:!1,cookieDuration:182,themeUrl:null};static#i={"cookie-legit-init":[],"notice-loaded":[],"consent-given":[],"consent-updated":[]};constructor(e,t){return this.#n=Object.assign({},this.defaultSettings,t),this.#e=this.selectTarget(e),this.checkConsentCookies(),this.insertNotice(),this.maybeInjectScripts(),this}buildStyle(e){const t=document.createElement("link");t.href=this.#n.themeUrl,t.rel="stylesheet",t.id="cookielegit-css",t.onload=()=>{e.style.display=""},document.head.append(t)}checkConsentCookies(){e.list().filter((e=>e.name.startsWith("cl_"))).forEach((e=>this.#s.push(e))),this.#n.consentMode&&this.#s.length>0&&this.updateGTMConsent(),this.#s.length>0&&t.#c("consent-given")}selectTarget(e){return document.querySelector(e)}async insertNotice(){let e=await this.fetchNotice();this.#t=document.createElement("div"),this.#t.id="cookie-legit-notice-container",this.#t.innerHTML=e.html,this.#t.style.display="none";let t=0===this.#s.length?"notice":"toggle-preferences";this.#t.classList.add(t),this.#e.appendChild(this.#t),this.setupEvents(),this.#n.userOpt&&this.setPrefToggles(),this.buildStyle(this.#t)}async fetchNotice(){const e=await fetch(`${this.#n.baseUrl}?action=get_cookie_notice`);return await e.json()}setupEvents(){this.#n.userOpt?(this.#t.querySelector(".cookie-legit-pref-btn").addEventListener("click",(()=>this.toggleUserPreferences())),this.#t.querySelector(".cookie-legit-save-pref-btn").addEventListener("click",(()=>this.savePreferences())),this.#t.querySelector(".cookie-legit-accept-pref-btn").addEventListener("click",(()=>this.acceptAllCookies()))):this.#t.querySelector(".cookie-legit-deny-btn").addEventListener("click",(()=>this.denyAllCookies())),this.#t.querySelector(".cookie-legit-preferences-change").addEventListener("click",(()=>this.updatePreferences())),this.#t.querySelector(".cookie-legit-accept-btn").addEventListener("click",(()=>this.acceptAllCookies()))}toggleUserPreferences(){this.changeScreen("preferences")}acceptAllCookies(){this.changeScreen("toggle-preferences"),this.cookieNames.forEach((t=>{e.create(t,!0,this.#n.cookieDuration)})),this.checkConsentCookies()}savePreferences(){this.changeScreen("toggle-preferences"),this.cookieNames.forEach((t=>{let n=t===this.consentCookieName||this.#t.querySelector(`input[name=${t}]`).checked;e.create(t,n,this.#n.cookieDuration)})),this.checkConsentCookies()}updatePreferences(){let e=this.#n.userOpt?"preferences":"notice";this.changeScreen(e),this.checkConsentCookies(),t.#c("consent-updated")}denyAllCookies(){this.changeScreen("toggle-preferences"),this.cookieNames.forEach((t=>{let n=t===this.consentCookieName;e.create(t,n,this.#n.cookieDuration)})),this.checkConsentCookies()}changeScreen(e){let t=this.screens.filter((t=>t!==e));this.#t.classList.remove(...t),this.#t.classList.add(e)}setPrefToggles(){this.#s.forEach((e=>{let t=this.#t.querySelector(`input[name=${e.name}]`);t&&(t.checked="true"===e.value)}))}async maybeInjectScripts(){if(!this.#n.userOpt||"true"!==e.find(this.consentCookieName))return;let t=await fetch(`${this.#n.baseUrl}?action=get_tracking_scripts`),n=await t.json();for(const e in n)if(Object.hasOwnProperty.call(n,e)){const t=n[e];Object.values(t).forEach((t=>{if(this.isJSON(t)){t=JSON.parse(t);for(const n in t)Object.hasOwnProperty.call(t,n)&&t[n].forEach((t=>{let s=this.buildScript(e,t,"srcs"===n);document.querySelector(e).append(s)}))}else{let n=this.buildScript(e,t);document.querySelector(e).append(n)}}))}}updateGTMConsent(){if("function"==typeof gtag)return gtag("consent","update",this.getGTMConsentObject());window.dataLayer=window.dataLayer||[],window.dataLayer.push({0:"consent",1:"update",2:this.getGTMConsentObject()})}getGTMConsentObject(){return{ad_storage:"true"===e.find("cl_marketing")?.value?"granted":"denied",ad_user_data:"true"===e.find("cl_marketing")?.value?"granted":"denied",ad_personalization:"true"===e.find("cl_marketing")?.value?"granted":"denied",analytics_storage:"true"===e.find("cl_tracking")?.value?"granted":"denied",security_storage:"granted"}}isJSON(e){try{JSON.parse(e)}catch(e){return!1}return!0}buildScript(e,t,n=!1){let s="head"===e?"script":"noscript",i=document.createElement(s);return n?(i.src=t,i):(i.textContent=t,i)}static subscribe(e,t){return this.#i[e]?"function"!=typeof t?console.warn(`Expected callback for ${e} got ${typeof t}`):void this.#i[e].push(t):console.warn(`Cannot subscribe to ${e} because it does not exist!`)}static#c(e){const t=this.#i[e];if(!t)return console.warn(`Cannot trigger ${e} because it does not exist!`);for(let e of t)e()}}jQuery((function(e){t.subscribe("consent-given",(function(){console.log("should update screens"),e("iframe[data-cl-src]").each((function(){e(this).attr("src",e(this).attr("data-cl-src"))})),e("script[type=cookielegitblock]").each((function(){e(this).attr("src",e(this).attr("data-cl-src")),e(this).attr("type",e(this).attr("data-cl-type"))}))})),window.cookieLegitNotice=new t("body",{consentMode:""!==cl_config.consent_mode,userOpt:""!==cl_config.user_opt,baseUrl:cl_config.ajax_url,themeUrl:cl_config.themeUrl})}))})(),e.p})();